// MyTextEntry.cs - GTK# Tutorial example
//
// Author: Andres Sayago
//         asath@ColombiaLinux.org
//
// (C) 2003 Andres Sayago
// ColombiaLinux - Universidad Autonoma de Bucaramanga
//

namespace GtkSharpTutorial
{
  using Gtk;
  using GtkSharp;
  using System;

  public class textEntrySample
  {
    // The entry_toggle_* functions use it
    static Entry entry;

    static void enter_callback(object obj, EventArgs args)
    {
      string entry_text = ((Entry) obj).Text;
      Console.WriteLine("Entry contents: " + entry_text);
    }

    static void entry_toggle_editable(object obj, EventArgs args)
    {
      entry.Editable = ((CheckButton) obj).Active;
    }

    static void entry_toggle_visibility(object obj, EventArgs args)
    {
      entry.Visible = ((CheckButton) obj).Active;
    }

    static void window_destroy(object obj, DeleteEventArgs args)
    {
      Application.Quit();
    }

    static void button_close(object obj, EventArgs args)
    {
      Application.Quit();
    }

    // Function for the Widgets building
    static void create_text_entry()
    {
      Window window;
      VBox vbox;
      HBox hbox;
      Button button;
      CheckButton check;
      int tmp_pos;

      // Create a new window
      window = new Window (WindowType.Toplevel);
      window.SetDefaultSize(200, 100);
      window.Title = "GTK Entry";
      window.DeleteEvent += new DeleteEventHandler(window_destroy);
      
      vbox = new VBox(false, 0);
      window.Add(vbox);
      vbox.Show();

      // Box to enter text
      entry = new Entry();
      entry.MaxLength = 50;
      // When the Enter key is pressed, print a message to the console
      entry.Activated += new EventHandler(enter_callback);
      entry.Text = "hello";
      tmp_pos = entry.Text.Length;
      // Demostration of the 'InsertText' function (-1 is at end)
      entry.InsertText(" world", ref tmp_pos);
      // Text selected
      entry.SelectRegion(0, entry.Text.Length);
      vbox.PackStart(entry, true, true, 0);
      entry.Show();

      hbox = new HBox(false, 0);
      vbox.Add(hbox);
      hbox.Show();

      check = new CheckButton("Editable");
      hbox.PackStart(check, true, true, 0);
      check.Toggled += new EventHandler(entry_toggle_editable);
      check.Active = true;
      check.Show();

      check = new CheckButton("Visible");
      hbox.PackStart(check, true, true, 0);
      check.Toggled += new EventHandler(entry_toggle_visibility);
      check.Active = true;
      check.Show();

      button = new Button(Gtk.Stock.Close);
      button.Clicked += new EventHandler(button_close);
      vbox.PackStart(button, true, true, 0);
      button.CanDefault = true;
      button.GrabDefault();
      button.Show();

      window.Show();
    }

    // Main function
    public static void Main(string[] args)
    {
      Application.Init ();
      create_text_entry();
      Application.Run ();
    }
  }
}


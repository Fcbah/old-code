<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:monodoc="http://www.go-mono.org/xml/monodoc">
<head>
	<title>Gtk# - Manual Menu Creation</title>

	<meta name ="DC.Description" content ="" />
	<meta name ="DC.Contributor" content ="Johannes Roith" />

	<link rel="stylesheet" type="text/css" href="../../../style.css" />

	<meta name = "CVS.English.Version" content = "1.7" />
</head>
<body>

	<p>In the true tradition of teaching, we'll show you the
	hard way first. :)</p>

	<p>There are three widgets that go into making a menubar
	and submenus:</p>

	<ul>
		<li>a menu item, which is what the user wants to
		select, e.g., "Save"</li>

		<li>a menu, which acts as a container for the menu
		items, and</li>

		<li>a menubar, which is a container for each of the
		individual menus.</li>
	</ul>This is slightly complicated by the fact that menu
	item widgets are used for two different things. They are
	both the widgets that are packed into the menu, and the
	widget that is packed into the menubar, which, when
	selected, activates the menu.

	<p>Let's look at the functions that are used to create
	menus and menubars. This first function is used to create a
	new menubar.</p>
	<pre class="code">
MenuBar menu_bar = new MenuBar();
</pre>This rather self explanatory function creates a new menubar.
You use the Add() method to pack this into a window, or the
box_pack functions to pack it into a box - the same as buttons.
	<pre class="code">
Menu file_menu = new Menu ();
</pre>This creates a new Menu object; it is never actually shown
(with Show() method), it is just a container for the menu items. I
hope this will become more clear when you look at the example
below.

	<p>The next calls are used to create menu items that are
	packed into the menu (and menubar).</p>
	<pre class="code">
MenuItem open_item = new MenuItem();

MenuItem open_item = new MenuItem("Open");
</pre>These calls are used to create the menu items that are to be
displayed. Remember to differentiate between a "menu" as created
with Menu and a "menu item" as created by the MenuItem functions.
The menu item will be an actual button with an associated action,
whereas a menu will be a container holding menu items.

	<p>The MenuItem("label") and MenuItem() creators are just
	as you'd expect after reading about the buttons. One
	creates a new menu item with a label already packed into
	it, and the other just creates a blank menu item.</p>

	<p>Once you've created a menu item you have to put it into
	a menu. This is done using the method Append of Menu
	object. In order to capture when the item is selected by
	the user, we need to connect to the activate signal in the
	usual way. So, if we wanted to create a standard File menu,
	with the options Open, Save, and Quit, the code would look
	something like:</p>
	<pre class="code">
    Menu file_menu = new Menu ();    /* Don't need to show menus */
    /* Create the menu items */
    MenuItem open_item = new MenuItem("Open");
    MenuItem save_item = new MenuItem("Save");
    MenuItem quit_item = new MenuItem("Quit");

    /* Add them to the menu */
    file_menu.Append (open_item);
    file_menu.Append (save_item);
    file_menu.Append (quit_item);

    /* Attach the callback functions to the activate signal */
    
    open_item.Activated += new EventHandler (menuitem_response);
    save_item.Activated += new EventHandler (menuitem_response);
    quit_item.Activated += new EventHandler (menuitem_response);
    
    /* We do need to show menu items */
    open_item.Show();
    save_item.Show();
    quit_item.Show();
</pre>At this point we have our menu. Now we need to create a
menubar and a menu item for the File entry, to which we add our
menu. The code looks like this:
	<pre class="code">
    MenuBar menu_bar = new MenuBar();
    window.Add (menu_bar);
    menu_bar.Show();

    MenuItem file_item = new MenuItem("File");
    file_item.Show();
</pre>Now we need to associate the menu with file_item. This is
done with the MenuItem's Submenu property. So, our example would
continue with
	<pre class="code">
    file_item.Submenu = file_menu;
</pre>All that is left to do is to add the menu to the menubar,
which is accomplished using the MenuBar's Append method
	<pre class="code">
public void Append (Gtk.Widget child);
</pre>which in our case looks like this:
	<pre class="code">
    menu_bar.Append (file_item);
</pre>If we wanted the menu right justified on the menubar, such as
help menus often are, we can use the RightJustified property (again
on file_item in the current example) before attaching it to the
menubar.
	<pre class="code">
public bool RightJustified { set; get; };
</pre>Here is a summary of the steps needed to create a menu bar
with menus attached:

	<p>Create a new Menu object</p>

	<p>Create a new MenuItem object for each item you wish to
	have on your menu. And use Menu's Append() method to put
	each of these new items on to the menu.</p>

	<p>Create a new MenuItem. This will be the root of the
	menu, the text appearing here will be on the menubar
	itself.</p>

	<p>Use the Submenu property of MenuItem to attach the menu
	to the root menu item (the one created in the above
	step).</p>

	<p>Create a new MenuBar. This step only needs to be done
	once when creating a series of menus on one menu bar.</p>

	<p>Use the MenuBar's Append() method to put the root menu
	onto the menubar.</p>

	<p>Creating a popup menu is nearly the same. The difference
	is that the menu is not posted "automatically" by a
	menubar, but explicitly by calling the Menu's Popup()
	method from a button-press event, for example. Take these
	steps:</p>

	<p>Create an event handling function. It needs to have the
	prototype</p>
	<pre class="code">
public delegate void EventHandler(object sender, EventArgs e);
</pre>and bind it to the Button's Pressed event with<br />
	<br />
	<pre class="code">
    button.Pressed += new EventHandler (button_press);
</pre>

	<p>So, in our EventHandler function for Pressed will call
	the Popup method like this:</p>
	<pre class="code">
    menu.Popup(null, null, null, IntPtr.Zero, 0, 0);
</pre>

	<p>This can be a menu which is also posted by a menu bar,
	as shown in the sample code.</p>

</body>
</html>

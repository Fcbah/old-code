<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:monodoc="http://www.go-mono.org/xml/monodoc">
<head>
<title>The Mono Handbook - Using GDB to Debug Mono Applications</title>
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<h1>Using GDB to Debug Mono Applications.</h1>

<h2>Preparing your Program</h2>

<p>
  To use the debugging facilities in Mono, you should compile your
  program with debugging information.   This is achieved by passing
  the <tt>-debug+</tt> or its alias <tt>-g</tt> option to the command
  line compiler.
</p>

<pre class="console">
      $ mcs -g hello.cs
</pre>

<p> 
  Stack traces in Mono by default do not include line-number
  information, as they have a performance hit on JIT compilation.  To
  obtain stack traces, pass the --debug option to mono when running
  your application:
</p>

<pre class="console">
      $ mono --debug hello.exe
</pre>

<p>Mono support libraries use a couple of signals internally that
confuse gdb, you might want to add this to your .gdbinit file:</p>

<pre>        handle SIGPWR nostop noprint 
        handle SIGXCPU nostop noprint 
</pre>

<p>
If you use GDB to debug your mono process, you can use the function print_method_from_ip(void *address) to obtain the name of a method given an address.
</p>

<p>For example:</p>

<pre class="console">
(gdb) where
#0  ves_icall_System_String_GetHashCode (me=0x80795d0) at string-icalls.c:861
#1  0x0817f490 in ?? ()
#2  0x0817f42a in ?? ()
#3  0x0817f266 in ?? ()
#4  0x0817f1a5 in ?? ()
</pre>
<p>
You can now use:
</p>
<pre class="console">
(gdb) p print_method_from_ip (0x0817f490)
IP 0x817f490 at offset 0x28 of method (wrapper managed-to-native) System.String:GetHashCode () (0x817f468 0x817f4a4)
$1 = void
(gdb) p print_method_from_ip (0x0817f42a)
IP 0x817f42a at offset 0x52 of method System.Collections.Hashtable:GetHash (object) (0x817f3d8 0x817f43b)
$2 = void
</pre>

</body>
</html>
